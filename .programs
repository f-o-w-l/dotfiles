# Helper function to prepend a dir to PATH if not already there
path_prepend() {
    case ":$PATH:" in
        *":$1:"*) ;;           # already in PATH, do nothing
        *) PATH="$1:$PATH";;
    esac
}

# Helper function to append a dir to PATH if not already there
path_append() {
    case ":$PATH:" in
        *":$1:"*) ;;           # already in PATH, do nothing
        *) PATH="$PATH:$1";;
    esac
}

# arcanist
path_append /opt/arcanist/bin

# go
path_prepend $HOME/go/bin

# yarn
path_append $HOME/.yarn/bin
path_append $HOME/.config/yarn/global/node_modules/.bin

# flyctl
export FLYCTL_INSTALL="$HOME/.fly"
path_append $FLYCTL_INSTALL/bin

# pnpm
export PNPM_HOME="$HOME/.local/share/pnpm"
path_prepend $PNPM_HOME

# asdf
path_prepend "${ASDF_DATA_DIR:-$HOME/.asdf}/shims"
# append completions to fpath
fpath=(${ASDF_DATA_DIR:-$HOME/.asdf}/completions $fpath)
# initialise completions with ZSH's compinit
autoload -Uz compinit && compinit

# Colored GCC warnings and errors
export GCC_COLORS='error=01;31:warning=01;35:note=01;36:caret=01;32:locus=01:quote=01'

# ROS
# Comment/uncomment per ROS distro to use
# export ROS1_DISTRO="noetic"
export ROS2_DISTRO="kilted"

if [ -n "$ZSH_VERSION" ]; then
    if [[ -n "$ROS1_DISTRO" ]]; then
        if [[ -f "/opt/ros/$ROS1_DISTRO/setup.zsh" ]]; then
            source "/opt/ros/$ROS1_DISTRO/setup.zsh"
        fi
    fi
    if [[ -n "$ROS2_DISTRO" ]]; then
        if [[ -f "/opt/ros/$ROS2_DISTRO/setup.zsh" ]]; then
            source "/opt/ros/$ROS2_DISTRO/setup.zsh"
        fi
    fi
else
    # Assume bash
    if [[ -n "$ROS1_DISTRO" ]]; then
        if [[ -f "/opt/ros/$ROS1_DISTRO/setup.bash" ]]; then
            source "/opt/ros/$ROS1_DISTRO/setup.bash"
        fi
    fi
    if [[ -n "$ROS2_DISTRO" ]]; then
        if [[ -f "/opt/ros/$ROS2_DISTRO/setup.bash" ]]; then
            source "/opt/ros/$ROS2_DISTRO/setup.bash"
        fi
    fi
fi
